name: CI

on:
  push:
    branches: ["**"]
  pull_request:
    branches: ["**"]

jobs :
  build-test:
    name: Build & Test (Maven, Java 21)
    runs-on: ubuntu-latest

    steps:
      # 1) Récupère le code du repo sur le runner GitHub
      - name: Checkout
        uses: actions/checkout@v4

      # 2) Installe Java 21 et active le cache Maven (accélère les builds)
      - name: Set up JDK 21
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: "21"
          cache: maven

      # 3) (Optionnel) Affiche la version de Maven/Java pour debug
      - name: Show Java & Maven versions
        run: |
          java -version
          mvn -version

      # 4) Lance la vérification complète Maven (compile + tests)
      # -B = batch mode (sortie plus propre pour CI)
      - name: Build and test
        run: mvn -B verify