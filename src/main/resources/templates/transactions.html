<!doctype html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Transférer</title>
</head>
<body>

<nav>
    <a href="#" aria-current="page">Transférer</a>
    <a href="#">Profil</a>
    <a href="#">Ajouter relation</a>
    <a href="#">Se déconnecter</a>
</nav>

<main>
    <h1>Transférer</h1>

    <!--  Error message  -->
    <div th:if="${transferError}" style="color: red; margin: 10px 0;">
        <p th:text="${transferError}"></p>
    </div>

    <!--  Transfer form  -->
    <form th:action="@{/transactions/transfer(userId=${param.userId})}"
          th:object="${transferForm}"
          method="post">

        <!-- Recipient -->
        <div>
            <label for="receiverId">Sélectionner une relation</label>
            <select id="receiverId" th:field="*{receiverId}">
                <option value="" disabled selected>-- Choisir --</option>
                <option th:each="c : ${contacts}"
                        th:value="${c.id}"
                        th:text="${c.userName} + ' (' + ${c.email} + ')'">
                </option>
            </select>

            <div th:if="${#fields.hasErrors('receiverId')}" style="color:red;">
                <span th:errors="*{receiverId}">Erreur destinataire</span>
            </div>
        </div>

        <!-- Description -->
        <div>
            <label for="description">Description</label>
            <input id="description" type="text" th:field="*{description}" placeholder="Description"/>

            <div th:if="${#fields.hasErrors('description')}" style="color:red;">
                <span th:errors="*{description}">Erreur description</span>
            </div>
        </div>

        <!-- Amount -->
        <div>
            <label for="amount">Montant (€)</label>
            <input id="amount" type="number" step="0.01" min="0.01" th:field="*{amount}" placeholder="0.00"/>

            <div th:if="${#fields.hasErrors('amount')}" style="color:red;">
                <span th:errors="*{amount}">Erreur montant</span>
            </div>
        </div>

        <div>
            <button type="submit">Payer</button>
        </div>
    </form>

    <!-- Transaction history -->
    <section style="margin-top: 30px;">
        <h2>Mes Transactions</h2>

        <table border="1" cellpadding="6" cellspacing="0">
            <thead>
            <tr>
                <th>Date</th>
                <th>Description</th>
                <th>Montant</th>
                <th>Frais</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${transactionHistory == null || transactionHistory.content == null || transactionHistory.content.isEmpty()}">
                <td colspan="4">Aucune transaction</td>
            </tr>

            <tr th:each="t : ${transactionHistory.content}">
                <td th:text="${t.date}">2026-01-01T12:00</td>
                <td th:text="${t.description}">Description</td>
                <td th:text="${t.amount}">0.00</td>
                <td th:text="${t.fee}">0.00</td>
            </tr>
            </tbody>
        </table>

        <!-- PAGINATION (simple) -->
        <div style="margin-top: 10px;" th:if="${transactionHistory != null}">
            <a th:if="${transactionHistory.hasPrevious()}"
               th:href="@{/transactions(userId=${param.userId}, page=${transactionHistory.number - 1}, size=${transactionHistory.size})}">
                Précédent
            </a>

            <span th:text="${transactionHistory.number + 1} + ' / ' + ${transactionHistory.totalPages}">1 / 1</span>

            <a th:if="${transactionHistory.hasNext()}"
               th:href="@{/transactions(userId=${param.userId}, page=${transactionHistory.number + 1}, size=${transactionHistory.size})}">
                Suivant
            </a>
        </div>
    </section>

</main>

</body>
</html>